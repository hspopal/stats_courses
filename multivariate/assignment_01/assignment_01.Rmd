---
title: "Assignment #1"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
plot(cars)
```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Cmd+Option+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Cmd+Shift+K* to preview the HTML file). 

The preview shows you a rendered HTML copy of the contents of the editor. Consequently, unlike *Knit*, *Preview* does not run any R code chunks. Instead, the output of the chunk when it was last run in the editor is displayed.

```{r}
# Assignment 1

library(tidyverse)
library(psych)
library(Hmisc)
library(gvlma)


# Set working directory to where relevant files are
setwd("~/Google_Drive/courses/Multivariate/homework/assignment_01/")
getwd()
```

# 1. Describe the dataset.
if(FALSE) {
  "This is a dataset of behavioral data from the human connectome project.
  This dataset consists of healthy participants who are siblings, with about 
  300 families in the dataset of 1,200 total participants. More information 
  about the recruitment for this dataset is available here: 
  https://www.humanconnectome.org/study/hcp-young-adult/project-protocol/recruitment
  
  There are multiple within-person assessments in this dataset. This includes 
  measures of cognitive status, episodic memory, language and reading, emotion 
  recognition, structural brain measures, and more. No univariate tests were 
  done on this dataset, nor were any measures transformed. Some participants 
  have missing data."
}

hcp_behav <- read.csv("~/Google_Drive/courses/Multivariate/homework/assignment_01/unrestricted_hspopal_9_9_2019_22_40_57.csv", 
                      row.names = 1, header = TRUE)
hcp_behav$Age <- as.character(hcp_behav$Age)

describe(hcp_behav)

ggplot(hcp_behav, aes(x=Age)) + geom_histogram(stat = "count")


# 2.a. Simple bivariate correlation analysis
cor.mat <- cor(as.matrix(hcp_behav[c("LifeSatisf_Unadj", "Friendship_Unadj")], use = "complete.obs"))
cor_p <- rcorr(as.matrix(hcp_behav[c("LifeSatisf_Unadj", "Friendship_Unadj")], use = "complete.obs"))

# 2.b. Regression analysis with one predictor variable
lifesatisf_on_friendship <- lm(Friendship_Unadj ~ LifeSatisf_Unadj, hcp_behav)
summary(lifesatisf_on_friendship)

hcp_behav <- mutate(hcp_behav, Friendship_Unadj_z = ((Friendship_Unadj - mean(Friendship_Unadj, na.rm = TRUE)) / sd(Friendship_Unadj, na.rm = TRUE)),
                 LifeSatisf_Unadj_z = ((LifeSatisf_Unadj - mean(LifeSatisf_Unadj, na.rm = TRUE)) / sd(LifeSatisf_Unadj, na.rm = TRUE)))

psych::describe(hcp_behav[c("LifeSatisf_Unadj_z", "Friendship_Unadj_z")])

lifesatisf_on_friendship_z <- lm(Friendship_Unadj_z ~ LifeSatisf_Unadj_z, hcp_behav)
summary(lifesatisf_on_friendship_z)

## Testing Assumptions
## Residuals Mean of 0
mean(lifesatisf_on_friendship_z$residuals)

## Heteroscedasticity
plot(lifesatisf_on_friendship_z)

### simultaneous look at plots
par(mfrow=c(2, 2))
plot(lifesatisf_on_friendship_z)

## Predictor and Residuals of Y are correlated
cor.test(lifesatisf_on_friendship$model$Friendship_Unadj, lifesatisf_on_friendship$residuals) 

## Complement of LM Assumption Checking
## Most useful for looking at the heteroscedasticity
mvn_check <- gvlma(lifesatisf_on_friendship, alphalevel = 0.000001)
mvn_check

# 2.c. Correlation and regression results comparison
if(FALSE) {
  "The r-value of the correlation analysis, the beta of the regression, 
  and the beta from the regression analysis of the standardized variables are 
  all the same. The difference is that in the regression of the standardized variables, the 
  units represent standard deviations."
}














